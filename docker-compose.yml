services:
  api-server:
    build:
      context: .
      dockerfile: api-server/Dockerfile
    container_name: api-server
    restart: unless-stopped
    ports:
      - "8000:8000"
    environment:
      KAFKA_BOOTSTRAP_SERVERS: "172.31.0.202:9092"
      KAFKA_TOPIC: "purchases.v1"
      KAFKA_GROUP_ID: "purchase-consumer"
      MONGO_URI: "mongodb://172.31.2.197:27017"
      MONGO_DB: "purchases_db"
      MONGO_COLLECTION: "purchases"

  web-server:
    build:
      context: .
      dockerfile: web-server/Dockerfile
    container_name: web-server
    restart: unless-stopped
    ports:
      - "9000:9000"
    environment:
      KAFKA_BOOTSTRAP_SERVERS: "172.31.0.202:9092"
      KAFKA_TOPIC: "purchases.v1"
      API_SERVER_URL: "http://api-server:8000"
